{% extends "base.html" %}
{% block title %}Extraction Jobs â€” BLM{% endblock %}

{% block content %}
<h1 class="section-title">Data Extraction Jobs</h1>
<p class="meta" style="margin-bottom: 20px;">Review and approve AI-extracted data before committing to database</p>

{% if not jobs %}
<div style="text-align:center;padding:48px;color:var(--light-text);">
    <div style="font-size:48px;margin-bottom:16px;">&#x1f4cb;</div>
    <h3>No extraction jobs yet</h3>
    <p>Go to <a href="/analyze" style="color:var(--primary-light);">Analyze</a> and use "Fetch Data" to start extracting.</p>
</div>
{% else %}
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Operator</th>
            <th>Market</th>
            <th>Period</th>
            <th>Status</th>
            <th>Report</th>
            <th>Created</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {% for job in jobs %}
        <tr>
            <td>#{{ job.id }}</td>
            <td>{{ job.operator_id }}</td>
            <td>{{ job.market }}</td>
            <td>{{ job.report_period or '-' }}</td>
            <td>
                <span class="badge {% if job.status == 'extracted' %}badge-positive{% elif job.status == 'approved' %}badge-primary{% elif job.status == 'error' %}badge-negative{% elif job.status == 'rejected' %}badge-negative{% else %}badge-warning{% endif %}">
                    {{ job.status }}
                </span>
            </td>
            <td style="max-width:200px;overflow:hidden;text-overflow:ellipsis;">
                {{ job.report_title or '-' }}
            </td>
            <td style="font-size:12px;color:var(--light-text);">
                {{ job.created_at[:16] if job.created_at else '-' }}
            </td>
            <td>
                {% if job.status in ['extracted', 'extracting', 'uploaded', 'discovered'] %}
                <a href="/review/{{ job.id }}" style="color:var(--primary-light);font-weight:600;">Review</a>
                {% elif job.status == 'approved' %}
                <a href="/review/{{ job.id }}" style="color:var(--light-text);">View</a>
                {% else %}
                <span style="color:var(--light-text);">-</span>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}
{% endblock %}
